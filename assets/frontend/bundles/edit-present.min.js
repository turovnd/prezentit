var pit=function(e){function t(s){if(n[s])return n[s].exports;var a=n[s]={i:s,l:!1,exports:{}};return e[s].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,s){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:s})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=17)}([function(e,t){e.exports=function(e){return e.log=function(e,t,n,s){for(n=void 0===n?"[prezentit]:":"["+n+"]:",n=n.length<25?n:n.substr(0,22);n.length<24;)n+=" ";t=t||"log",s?e=n+e:(s=e||"undefined",e=n+"%o");try{"console"in window&&window.console[t]&&(s?window.console[t](e,s):window.console[t](e))}catch(e){}},e.insertBefore=function(e,t){e.parentNode.insertBefore(t,e)},e.insertAfter=function(e,t){e.parentNode.insertBefore(t,e.nextSibling)},e.replace=function(e,t){return e.parentNode.replaceChild(t,e)},e.keys={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,LEFT:37,UP:38,DOWN:40,RIGHT:39,DELETE:46,META:91,Q:81,I:73,H:72,F:70,C:67,E:69,P:80},e}({})},function(e,t){e.exports=function(e){e.nodes=[],e.btn=null,e.list=null,e.init=function(){if(e.nodes=document.querySelectorAll('[data-toggle="collapse"]'),e.nodes.length>0)for(var s=0;s<e.nodes.length;s++)e.nodes[s].addEventListener("click",t,!1),"true"==e.nodes[s].dataset.opened&&n(e.nodes[s],document.getElementById(e.nodes[s].dataset.area))};var t=function(){e.btn=this,e.list=document.getElementById(e.btn.dataset.area),"false"===e.btn.dataset.opened?n(e.btn,e.list):s(e.btn,e.list)},n=function(e,t){e.dataset.opened="true",t.dataset.height||(t.dataset.height=a(t)),t.style.height=t.dataset.height+"px"},s=function(e,t){e.dataset.opened="false",t.style.height="0"},a=function(e){for(var t=0,n=0;n<e.childNodes.length;n++)e.childNodes[n].className&&(t+=e.childNodes[n].clientHeight);return t};return e}({})},function(e,t){var n=function(){var e=function(e){var t=document.cookie.match(RegExp(e+"=([^;]*)"));return t?decodeURIComponent(t[1]).split("~")[1]:void 0},t=function(e){e=e||{};var t=e.expires;if("number"==typeof t&&t){var n=new Date;n.setTime(n.getTime()+1e3*t),t=e.expires=n}t&&t.toUTCString&&(e.expires=t.toUTCString());var s=encodeURIComponent(e.value),a=e.name+"="+s;for(var i in e)if("name"!=i&&"value"!=i){a+="; "+i;var o=e[i];!0!==o&&(a+="="+o)}document.cookie=a};return{get:e,set:t,remove:function(e){t({name:e,value:"",expires:-1,path:"/"})}}}();e.exports=n},function(e,t){e.exports=function(e){var t=[],n=null,s=function(e){t.push(e);for(var n=0;n<t.length&&t.length>5;)"confirm"!==t[n].type&&"prompt"!==t[n].type?(t[n].close(),t.splice(n,5)):n++};return e.createHolder=function(){var e=pit.draw.node("DIV","notifications-block");return n=document.body.appendChild(e),e},e.notify=function(e){function t(e){if(!e||!e.message)return void console.log("Can't create notification. Message is missed");e.type=e.type||"alert",e.time=1e3*e.time||3e3;var t=pit.draw.node("DIV","notification"),n=pit.draw.node("DIV","notification__message"),s=pit.draw.node("INPUT","notification__input"),a=pit.draw.node("SPAN","notification__confirm-btn"),f=pit.draw.node("SPAN","notification__cancel-btn"),_=pit.draw.node("DIV","notification__backdrop");n.innerHTML=e.message,e.size&&t.classList.add("notification--"+e.size),t.classList.add("notification--"+e.type),t.appendChild(n),"prompt"!==e.type&&"confirm"!==e.type||(a.textContent=e.confirmText||"ОК",f.textContent=e.cancelText||"Отмена",m=document.body.appendChild(_),m.addEventListener("click",g),"prompt"===e.type&&t.appendChild(s),t.appendChild(a),e.showCancelButton&&(t.appendChild(f),f.addEventListener("click",g)),a.addEventListener("click",p)),"prompt"!==e.type&&"confirm"!==e.type&&window.setTimeout(i,e.time),o=t,l=e.type,u=e.validation,c=e.confirm,r=e.cancel,d=s}function a(){n.appendChild(o),d.focus(),"prompt"===l||"confirm"===l?(o.classList.add("notification--animation-in"),window.setTimeout(function(){o.classList.remove("notification--animation-in")},400)):(o.classList.add("notification--animation-in-down"),window.setTimeout(function(){o.classList.remove("notification--animation-in-down")},400)),s({type:l,close:i})}function i(){"prompt"===l||"confirm"===l?o.classList.add("notification--animation-out"):o.classList.add("notification--animation-in-up"),window.setTimeout(function(){o.remove(),m&&m.remove()},400)}var o=null,r=null,l=null,c=null,d=null,m=null,u=null,p=function(){if(u||i(),"function"==typeof c)return"prompt"===l?void c(d.value):void c()},g=function(){i(),"function"==typeof r&&r()};return e&&(t(e),a()),{create:t,send:a,close:i}},e.clear=function(){n=null,t=[]},e}({})},function(e,t){},function(e,t){e.exports=function(e){return e.node=function(e,t,n){var s=document.createElement(e);s.className+=t;for(var a in n)s.setAttribute(a,n[a]);return s},e}({})},function(e,t){var n=function(){var e=function(e){return"function"==typeof e.append};return{send:function(t){if(t&&t.url){var n=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),s=function(){};t.async=!0,t.type=t.type||"GET",t.data=t.data||"",t["content-type"]=t["content-type"]||"application/json; charset=utf-8",s=t.success||s,"GET"==t.type&&t.data&&(t.url=/\?/.test(t.url)?t.url+"&"+t.data:t.url+"?"+t.data),t.withCredentials&&(n.withCredentials=!0),t.beforeSend&&"function"==typeof t.beforeSend&&t.beforeSend.call(),n.open(t.type,t.url,t.async),e(t.data)||n.setRequestHeader("Content-type",t["content-type"]),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.onreadystatechange=function(){4==n.readyState&&200==n.status&&s(n.responseText)},n.send(t.data)}}}}();e.exports=n},function(e,t){e.exports=function(e){e.types=[];var t,n,s=null,a=null,i=null,o=null,r=null,l=window.location.pathname.split("/"),c="/"+l[1]+"/"+l[2],d=function(){s=document.getElementById("openAside"),s.addEventListener("click",m,!1),a=document.getElementsByClassName("aside")[0],i=document.getElementsByClassName("backdrop")[0],i&&i.addEventListener("click",u,!1),o=document.getElementsByClassName("aside__link"),r=document.getElementsByClassName("aside__collapse-link"),p()};e.init=function(){d(),window.onresize=function(){window.innerWidth>768&&u()}};var m=function(){s.classList.contains("aside__open-btn--opened")?u():(s.classList.add("aside__open-btn--opened"),a.classList.add("aside--opened"),i.classList.remove("hide"),document.body.classList.add("overflow--hidden"))},u=function(){s.classList.remove("aside__open-btn--opened"),a.classList.remove("aside--opened"),i.classList.add("hide"),document.body.classList.remove("overflow--hidden")},p=function(){for(n=0;n<o.length;n++)o[n].href&&(t=o[n].getAttribute("href").split("/"),t=new RegExp(t[1]+"/"+t[2]),t.test(c)&&(o[n].parentNode.classList.add("aside__item--active"),o[n].classList.add("aside__link--active")));for(n=0;n<r.length;n++)r[n].href&&(t=r[n].getAttribute("href").split("/"),t=new RegExp(t[1]+"/"+t[2]),t.test(c)&&(r[n].parentNode.parentNode.parentNode.classList.add("aside__item--active--active"),r[n].classList.add("aside__collapse-link--active")))};return e}({})},function(e,t){e.exports=function(e){var t=null,n=null,s=function(){t=document.getElementsByTagName("input"),n=document.getElementsByTagName("textarea");for(var s=0;s<t.length;s++)t[s].hasAttribute("maxlength")&&e.createCounter(t[s],t[s].maxLength);for(var s=0;s<n.length;s++)n[s].hasAttribute("maxlength")&&e.createCounter(n[s],n[s].maxLength)};e.init=function(){s()};var a=function(e){var t=e.target||e;t.parentNode.children[1].innerHTML=t.maxLength-t.value.length};return e.createCounter=function(e,t){var n=document.createElement("div"),s=document.createElement("span"),i=e.parentNode;s.classList.add("counter-block"),s.innerHTML=t,e.classList.add("input-with-counter"),n.classList.add("input-with-counter-block"),n.appendChild(e),n.appendChild(s),i.classList.contains("form-group__control-group")?i.insertBefore(n,i.childNodes[0]):i.appendChild(n),a(e),e.addEventListener("keyup",a)},e}({})},function(e,t){e.exports=function(e){function t(t){u=document.getElementsByClassName("presentation__aside-open")[0],p=document.getElementById("toggleInstruction"),g=document.getElementsByClassName("presentation")[0],f=document.getElementsByClassName("presentation__slide"),_=window.location.pathname.split("/")[3],h=document.getElementsByClassName("presentation__navigation-btn--right")[0],y=document.getElementsByClassName("presentation__navigation-btn--left")[0],w=document.getElementsByClassName("presentation__progress-bar")[0],E=""===document.getElementById("slides_order").value?[]:document.getElementById("slides_order").value.split(",");for(var s=0;s<E.length;s++)E[s]=parseInt(E[s]);if(u&&!t.aside&&u.remove(),h&&t.slideNavigation&&h.addEventListener("click",e.toNextSlide),y&&t.slideNavigation&&y.addEventListener("click",e.toPrevSlide),t.toggleAnswers)for(var i=document.getElementsByClassName("slide-choices__action-btn"),s=0;s<i.length;s++)i[s].addEventListener("click",a);t.keyboard&&document.addEventListener("keydown",m),pit.cookies.get("cur_slide")&&pit.cookies.get("cur_slide").match(new RegExp(_))?(v=parseInt(pit.cookies.get("cur_slide").replace(window.location.pathname.split("/")[3],"")),E.indexOf(v)||(v=E[0])):v=E[0],l(),n()}function n(){L=[];for(var e=document.getElementsByClassName("slide-choices"),t=0;t<e.length;t++){for(var n,a,r,l=[],c=e[t].getElementsByClassName("slide-choices__option-wrapper"),d=null,m=[],u=o(c),p=0;p<c.length;p++)n=c[p].getElementsByClassName("slide-choices__option-score")[0],a=c[p].getElementsByClassName("slide-choices__option-image")[0],r=c[p].getElementsByClassName("slide-choices__option-bar")[0],d={wrapper:c[p],score:{wrapper:n,score:parseInt(n.innerHTML),bottom:parseInt(0)},img:{wrapper:a,height:a?parseFloat(a.clientWidth):0,bottom:0},bar:{wrapper:r,height:parseFloat(r.clientHeight)}},n.addEventListener("change",s),m.push(d);l={wrapper:e[t],maxScore:u,answers:m,inPercents:parseInt(e[t].getElementsByClassName("results-in-percents")[0].value)},L.push(l),i(l),window.matchMedia("(max-width: 992px)").addListener(function(){i(l)})}}function s(){i(this.closest(".slide-choices__option-wrapper"))}function a(){var e=this,t=this.parentNode.parentNode.getElementsByClassName("slide-choices__content")[0],n=this.parentNode.parentNode.getElementsByClassName("slide-choices__image")[0],s=this.getElementsByClassName("slide-choices__action-icon")[0],a=this.getElementsByClassName("slide-choices__action-text")[0];switch(s.classList.toggle("slide-choices__action-icon--clicked"),e.dataset.status){case"image":a.textContent="Показать результаты",n.classList.remove("hide","fade__in","fade__in--up"),n.classList.add("fade__out--down"),t.classList.remove("hide","fade__in","fade__out--down"),t.classList.add("fade__in--up"),e.dataset.status="result";break;case"result":a.textContent="Показать изображение",n.classList.remove("hide","fade__in","fade__out--down"),n.classList.add("fade__in--up"),t.classList.remove("hide","fade__in","fade__out--down"),t.classList.add("fade__out--down"),e.dataset.status="image"}t.classList.toggle("fade__in--up","fade__out--down")}function i(e){e.maxScore=o(e.wrapper.getElementsByClassName("slide-choices__option-wrapper"));for(var t=0;t<e.answers.length;t++){var n=e.answers[t],s=e.answers[0].wrapper.clientHeight;n.img.height=void 0!==n.img.wrapper?parseFloat(n.img.wrapper.clientWidth/(s/70)):0;var a=void 0!==n.img.wrapper?n.img.height:0,i=0===n.score.score?0:parseFloat(48*n.score.score/e.maxScore-a/2);void 0===n.img.wrapper?(n.score.bottom=12+i,n.bar.height=i):(n.bar.height=i>0?i:0,n.img.bottom=i>0?12+i:12,n.score.bottom=n.img.bottom+a),n.bar.wrapper.style.height=n.bar.height+"vh",n.score.wrapper.style.bottom=n.score.bottom+"vh",n.score.wrapper.textContent=0===e.inPercents?n.score.score:parseInt(n.score.score/r(e.wrapper.getElementsByClassName("slide-choices__option-wrapper"))*100)+"%",void 0!==n.img.wrapper&&(n.img.wrapper.style.bottom=n.img.bottom+"vh")}}function o(e){for(var t=0,n=0,s=0;s<e.length;s++)n=parseInt(e[s].getElementsByClassName("slide-choices__option-score")[0].dataset.score),t=t<n?n:t;return t=0===t?1:t}function r(e){for(var t=0,n=0;n<e.length;n++)t+=parseInt(e[n].getElementsByClassName("slide-choices__option-score")[0].dataset.score);return t=0===t?1:t}function l(){pit.cookies.set({name:"cur_slide",value:"presentation~"+window.location.pathname.split("/")[3]+v,expires:21600,path:"/"});for(var e=0;e<f.length;e++)e<E.indexOf(v)?(f[e].classList.remove("presentation__slide--active","presentation__slide--after"),f[e].classList.add("presentation__slide--before","presentation__slide--inactive")):e>E.indexOf(v)&&(f[e].classList.remove("presentation__slide--active","presentation__slide--before"),f[e].classList.add("presentation__slide--after","presentation__slide--inactive"));-1!==E.indexOf(v)&&(f[E.indexOf(v)].classList.remove("presentation__slide--after","presentation__slide--before","presentation__slide--inactive"),f[E.indexOf(v)].classList.add("presentation__slide--active"),w.style.width=parseInt(E.indexOf(v)/(f.length-1)*100)+"%"),0===E.indexOf(v)?y.classList.add("hide"):y.classList.remove("hide"),E.indexOf(v)===f.length-1?h.classList.add("hide"):h.classList.remove("hide")}function c(e){e.requestFullScreen?e.requestFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen&&e.webkitRequestFullScreen()}function d(){document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()}function m(t){var n=t.keyCode;if(n===pit.core.keys.RIGHT||n===pit.core.keys.SPACE)return void e.toNextSlide();if(n===pit.core.keys.LEFT)return void e.toPrevSlide();if(n!==pit.core.keys.Q){if(n===pit.core.keys.I)return void e.toggleInstruction();if(n!==pit.core.keys.H){if(n===pit.core.keys.F)return void e.toggleFullScreen();pit.core.keys.C,n===pit.core.keys.E&&(window.history.pushState("Presentation",window.location),window.location.replace(window.location+"/edit"))}}}var u=null,p=null,g=null,f=null,_=null,v=null,h=null,y=null,w=null,E=null,L=null;return e.addScore=function(e,t){L[e].answers[t].score.score+=1,L[e].answers[t].score.wrapper.dataset.score=L[e].answers[t].score.score,i(L[e])},e.toNextSlide=function(){E.indexOf(v)<f.length-1&&(v=E[E.indexOf(v)+1],l(),pit.core.log("Switch to the next slide","log","presentation"))},e.toPrevSlide=function(){E.indexOf(v)>0&&(v=E[E.indexOf(v)-1],l(),pit.core.log("Switch to the previous slide","log","presentation"))},e.toggleFullScreen=function(){g?"true"===g.dataset.fullscreen?(g.dataset.fullscreen=!1,d()):(g.dataset.fullscreen=!0,c(g)):pit.core.log("Full screen button doesn't exist","error","presentation")},e.toggleInstruction=function(){p?"false"===p.dataset.opened?(p.classList.toggle("hide"),p.classList.contains("hide")||(p.children[1].removeAttribute("data-height"),p.click())):p.click():pit.core.log("Instructions doesn't exist","error","presentation")},e.init=function(e){t(e),pit.core.log("Module loaded","log","presentation")},e}({})},function(e,t){e.exports=function(e){var t=null,n=[],s=null,a=null,i=function(e){if(a=document.createElement("div"),a.id="noResult",a.style="padding: 20px;text-align: center;",a.innerHTML="К сожалению, ничего ненеайдено. Попробуйте изменить запрос",t=document.querySelectorAll('[data-toggle="tabs"]'),t.length>0)for(var i=0;i<t.length;i++)s={btn:t[i],block:document.getElementById(t[i].dataset.block),search:e.search?document.getElementById(t[i].dataset.search):"",input:e.search?document.getElementById(t[i].dataset.search+"Input"):"",counter:e.counter?document.getElementById(t[i].dataset.block+"Counter"):"",searchElements:e.search?document.getElementById(t[i].dataset.block).getElementsByClassName("item__info-name"):""},n.push(s),n[i].btn.dataset.id=i,n[i].btn.addEventListener("click",o,!1),n[i].input&&(n[i].input.dataset.id=i,n[i].input.addEventListener("keyup",r,!1))};e.init=function(e){i(e)};var o=function(){for(var e=0;e<n.length;e++)n[e].btn.classList.remove("tabs__btn--active"),n[e].block.classList.remove("tabs__block--active"),n[e].search&&n[e].search.classList.remove("tabs__search-block--active");n[this.dataset.id].btn.classList.add("tabs__btn--active"),n[this.dataset.id].block.classList.add("tabs__block--active"),n[this.dataset.id].search&&n[this.dataset.id].search.classList.add("tabs__search-block--active")},r=function(){for(var e,t,s,i=n[this.dataset.id],o=new RegExp(i.input.value.toLowerCase()),r=0;r<i.searchElements.length;r++)t=i.searchElements[r].getElementsByTagName("a")[0],e=t.parentNode.parentNode.parentNode,s=t.innerHTML.toLowerCase(),o.test(s)?(t.parentNode.parentNode.parentNode.classList.contains("hide")&&(i.counter.innerHTML=parseInt(i.counter.innerHTML)+1),t.parentNode.parentNode.parentNode.classList.remove("hide")):(e.classList.contains("hide")||(i.counter.innerHTML=parseInt(i.counter.innerHTML)-1),t.parentNode.parentNode.parentNode.classList.add("hide")),0==parseInt(i.counter.innerHTML)?e.parentNode.append(a):document.getElementById("noResult")&&document.getElementById("noResult").remove()};return e}({})},function(e,t){e.exports=function(e){var t=null,n=null,s=function(e){t=e,n=pit.draw.node("INPUT","",{type:"file"}),t.multiple&&(n.multiple=!0),t.accept&&(n.accept=t.accept),n.click(),n.addEventListener("change",a)},a=function(){var e=n.files[0],s=new FormData;s.append("files",e,e.name),s.append("params",JSON.stringify(t.params)),pit.ajax.send({url:t.url,type:"POST",data:s,beforeSend:t.beforeSend,success:t.success,error:t.error})};return e.init=function(e){s(e)},e.getInput=function(){return n},e}({})},function(e,t){},function(e,t){e.exports=function(e){function t(){return J=document.getElementById("PresentName"),U=document.getElementById("editPresentNameBtn"),X=document.getElementById("editPresentNameFrom"),W=document.getElementById("editPresentNameInput"),!(!(G=document.getElementById("editPresentNameBtnSubmit"))||!U)&&(G.addEventListener("click",x),U.addEventListener("click",A),!0)}function n(){var e=document.getElementById("newSlide");return!!e&&(e.addEventListener("click",r),!0)}function s(){return D=document.getElementsByClassName("presentation")[0],z=document.getElementById("presentation_id").value,b(),window.addEventListener("resize",b),!0}function a(){Y=document.getElementsByClassName("aside__menu")[0],ne=""===document.getElementById("slides_order").value?[]:document.getElementById("slides_order").value.split(","),se=window.location.pathname.split("/")[3];var e=document.getElementsByClassName("js-select-slide"),t=document.getElementsByClassName("js-delete-slide"),n=!1;pit.cookies.get("cur_slide")&&pit.cookies.get("cur_slide").match(new RegExp(se))&&(ae=parseInt(pit.cookies.get("cur_slide").replace(window.location.pathname.split("/")[3],"")));for(var s=0;s<e.length;s++)e[s].addEventListener("click",p),t[s].addEventListener("click",f),e[s].parentNode.id==="aside_"+ae&&(n=!0);return e.length>0&&(n||(ae=e[0].parentNode.id.split("_")[1],pit.cookies.set({name:"cur_slide",value:"presentation~"+window.location.pathname.split("/")[3]+ae,expires:21600,path:"/"})),g(ae)),!0}function i(){ie=document.getElementsByClassName("config__status")[0],Z=document.getElementById("configContent"),oe=document.getElementsByClassName("js-ajax-edited");for(var e=0;e<oe.length;e++)oe[e].addEventListener("keyup",B);for(var t=document.getElementsByClassName("bg-image"),e=0;e<t.length;e++)t[e].classList.contains("bg-image--with-image")?t[e].addEventListener("click",S):t[e].addEventListener("click",I);for(var n=document.getElementsByClassName("checkbox"),e=0;e<n.length;e++)n[e].addEventListener("click",C);te=document.getElementsByClassName("presentation__slide");for(var e=0;e<te.length;e++)te[e].classList.remove("presentation__slide--after","presentation__slide--before");return!0}function o(){re=[];for(var e=document.getElementsByClassName("answer"),t=null,n=null,s=null,a=0;a<e.length;a++){t=[],e[a].dataset.answer=a,s=e[a].getElementsByClassName("answer__item");for(var i=0;i<s.length;i++){s[i].getElementsByClassName("js-option-delete")[0].addEventListener("click",T),s[i].getElementsByClassName("js-option-delete")[0].dataset.number=i;var o=s[i].getElementsByClassName("answer__value")[0],r=s[i].getElementsByClassName("answer__image")[0];n={text:o.value,image:r&&""!==r.getElementsByClassName("bg-image__image")[0].dataset.src?r.getElementsByClassName("bg-image__image")[0].dataset.src:""},o.addEventListener("keyup",M),o.dataset.number=i,r&&(""===r.getElementsByClassName("bg-image__image")[0].dataset.src?r.addEventListener("click",O):r.addEventListener("click",H),r.dataset.number=i),r=o=null,t.push(n)}re.push(t)}for(var l=document.getElementsByClassName("answers-with-image"),c=document.getElementsByClassName("js-option-add"),a=0;a<l.length;a++)l[a].addEventListener("click",F);for(var a=0;a<c.length;a++)c[a].addEventListener("click",j);return!0}function r(){V=pit.notification.notify({type:"confirm",size:"large",message:'<div class="new-slide"><h2 class="new-slide__title">Новый слайд</h2><div class="new-slide__wrapper">'+l()+"</div></div>",showCancelButton:!0,confirmText:"Создать",cancelText:"Закрыть",validation:!0,confirm:u,cancel:m}),Q=document.getElementsByClassName("new-slide__content");for(var e=document.getElementsByClassName("new-slide__close-icon"),t=0;t<Q.length;t++)Q[t].addEventListener("click",c),e[t].addEventListener("click",d)}function l(){for(var e,t="",n=0;n<le.length;n++){if(e="",t+='<div class="new-slide__block" data-type="'+le[n].type+'"><i class="fa fa-close new-slide__close-icon" aria-hidden="true"></i><div class="new-slide__content"><p class="new-slide__name">'+le[n].name+'</p><img class="new-slide__image" src="/assets/static/img/slides/types/'+le[n].image+'"><i class="fa '+le[n].icon+' new-slide__icon" aria-hidden="true"></i></div>',void 0!==le[n].options){e+='<div class="new-slide__options-wrapper">';for(var s=0;s<le[n].options.length;s++)e+='<div class="new-slide__option"><input type="'+le[n].options[s].type+'" id="'+le[n].options[s].id+'" name="'+le[n].options[s].name+'" data-name="'+le[n].options[s].data_name+'" data-value="'+le[n].options[s].data_value+'" class="checkbox"><label for="'+le[n].options[s].id+'" class="checkbox-label">'+le[n].options[s].title+"</label></div>";e+="</div>"}t+=e+"</div>"}return t}function c(){K=this;for(var e=0;e<Q.length;e++)Q[e].parentNode.classList.add("hide");K.parentNode.classList.remove("hide"),K.removeEventListener("click",c),K.parentNode.classList.add("new-slide__block--selected")}function d(){K.addEventListener("click",c),K.parentNode.classList.remove("new-slide__block--selected"),K=null;for(var e=0;e<Q.length;e++)Q[e].parentNode.classList.remove("hide")}function m(){for(var e=0;e<Q.length;e++)Q[e].removeEventListener("click",c);Q=null}function u(){if(null===K)return pit.notification.notify({message:"Пожалуйста выберите тип слайда",type:"error"}),pit.core.log("New slide type has not chosen","error",q),!1;var e=document.getElementsByClassName("new-slide")[0];e.classList.add("loading");var t=new FormData,n=K.parentNode.dataset.type,s=K.nextSibling,a=null;if(K=null,t.append("type",n),t.append("presentation",z),s)for(var i=0;i<s.childElementCount;i++)(a=s.children[i].querySelector("input:checked"))&&t.append(a.dataset.name,a.dataset.value);var o={url:"/slide/add",type:"POST",data:t,success:function(t){if(t=JSON.parse(t),pit.notification.notify({type:t.status,message:t.message}),e.classList.remove("loading"),70!==parseInt(t.code))return pit.core.log(t.message,"error",q),!1;v(t.aside,t.slideId),y(t.config,t.slideId),E(t.slide,t.slideId),N("add",t.slideId),g(t.slideId),pit.core.log("New slide with type="+n+" has been created","",q),V.close(),V=null},error:function(t){return pit.core.log("ajax error occur on sending new slide data","error",q,t),e.classList.remove("loading"),!1}};pit.ajax.send(o)}function p(){ae=this.parentNode.id.split("_")[1],g(ae)}function g(e){document.getElementsByClassName("aside__item--active")[0]&&document.getElementsByClassName("aside__item--active")[0].classList.remove("aside__item--active"),document.getElementsByClassName("config__item--active")[0]&&document.getElementsByClassName("config__item--active")[0].classList.remove("config__item--active"),document.getElementsByClassName("presentation__slide--active")[0]&&(document.getElementsByClassName("presentation__slide--active")[0].classList.add("presentation__slide--inactive"),document.getElementsByClassName("presentation__slide--active")[0].classList.remove("presentation__slide--active")),document.getElementById("aside_"+e).classList.add("aside__item--active"),document.getElementById("config_"+e).classList.add("config__item--active"),document.getElementById("slide_"+e).classList.remove("presentation__slide--inactive"),document.getElementById("slide_"+e).classList.add("presentation__slide--active"),pit.cookies.set({name:"cur_slide",value:"presentation~"+window.location.pathname.split("/")[3]+e,expires:21600,path:"/"})}function f(){$=pit.notification.notify({type:"confirm",message:'<div class="delete-slide"><h2 class="">Удаление слайда</h2><p>Вы уверены что хотите удалить? Удалив слайд у Вас не будет возможности его восстановить.</p></div>',showCancelButton:!0,confirmText:"Удалить",cancelText:"Закрыть",validation:!0,confirm:_}),ee=this.id.split("_")[1]}function _(){var e=new FormData,t=document.getElementsByClassName("delete-slide")[0];e.append("id",ee),e.append("presentation",z);var n={url:"/slide/delete",type:"POST",data:e,beforeSend:function(){t.classList.add("loading")},success:function(e){if(e=JSON.parse(e),pit.notification.notify({type:e.status,message:e.message}),t.classList.remove("loading"),73!==parseInt(e.code))return pit.core.log(e.message,"error",q),!1;h(ee),w(ee),document.getElementById("slide_"+ee).remove(),N("remove",ee),pit.core.log("Slide with id="+ee+" has been deleted","",q),$.close(),ee=null,$=null},error:function(e){return pit.core.log("ajax error occur on deleting slide","error",q,e),t.classList.remove("loading"),!1}};pit.ajax.send(n)}function v(e,t){var n=pit.draw.node("A","aside__item",{id:"aside_"+t,role:"button"});n.innerHTML='<span class="aside__item-number">'+parseInt(document.getElementsByClassName("js-select-slide").length+1)+'</span><span class="aside__item-action"><i id="delete_'+t+'" class="fa fa-trash aside__item-action-icon text-danger js-delete-slide" aria-hidden="true"></i></span>'+e,Y.appendChild(n),document.getElementById("aside_"+t).getElementsByClassName("js-select-slide")[0].addEventListener("click",p),document.getElementById("delete_"+t).addEventListener("click",f)}function h(e){document.getElementById("aside_"+e).getElementsByClassName("js-select-slide")[0].removeEventListener("click",p),document.getElementById("delete_"+e).removeEventListener("click",f);var t=null;document.getElementById("aside_"+e).classList.contains("aside__item--active")&&ne.length>1&&(t=0===ne.indexOf(e)?ne[1]:ne[ne.indexOf(e)-1],g(t)),document.getElementById("aside_"+e).remove(),L()}function y(e,t){var n=pit.draw.node("LI","config__item",{id:"config_"+t});n.innerHTML=e,Z.appendChild(n);for(var s=n.getElementsByClassName("js-ajax-edited"),a=n.getElementsByClassName("bg-image"),i=n.getElementsByClassName("checkbox"),o=n.getElementsByClassName("answer")[0],r=0;r<s.length;r++)s[r].addEventListener("keyup",B);for(var r=0;r<a.length;r++)a[r].addEventListener("click",I);for(var r=0;r<i.length;r++)i[r].addEventListener("click",C);if(o){o.dataset.answer=re.length;for(var l=o.getElementsByClassName("answer__item"),c=[],d=0;d<l.length;d++){l[d].getElementsByClassName("js-option-delete")[0].addEventListener("click",T),l[d].getElementsByClassName("js-option-delete")[0].dataset.number=d;var m=l[d].getElementsByClassName("answer__value")[0],u=l[d].getElementsByClassName("answer__image")[0];o={text:"",image:""},m.addEventListener("keyup",M),m.dataset.number=d,u&&(u.addEventListener("click",O),u.dataset.number=d),u=m=null,c.push(o)}re.push(c)}n=null,s=null,a=null,i=null,o=null}function w(e){for(var t=document.getElementById("config_"+e).getElementsByClassName("js-ajax-edited"),n=document.getElementById("config_"+e).getElementsByClassName("bg-image"),s=document.getElementById("config_"+e).getElementsByClassName("checkbox"),a=0;a<t.length;a++)t[a].removeEventListener("keyup",B);for(var a=0;a<n.length;a++)n[a].removeEventListener("click",I);for(var a=0;a<s.length;a++)s[a].removeEventListener("click",C);t=null,n=null,s=null,document.getElementById("config_"+e).remove()}function E(e,t){var n=pit.draw.node("SECTION","presentation__slide",{id:"slide_"+t}),s=document.getElementsByClassName("presentation__slides")[0];n.innerHTML=e,s.appendChild(n)}function L(){for(var e=document.getElementsByClassName("aside__item-number"),t=0;t<e.length;t++)e[t].textContent=parseInt(t+1)}function N(e,t,n){switch(e){case"add":ne.push(t);break;case"remove":var s=0;s=ne.indexOf(t),ne.splice(s,1)}var a=new FormData;a.append("presentation",z),a.append("order",ne.join(","));var i={url:"/slide/update/order",type:"POST",data:a,success:function(e){if(e=JSON.parse(e),74!==parseInt(e.code))return pit.core.log(e.message,"error",q),!1},error:function(e){return pit.core.log("ajax error occur on deleting slide","error",q,e),!1}};pit.ajax.send(i)}function b(){var e=window.innerWidth,t=(window.innerHeight,e>768?220:40),n=e>768?(e-590)/e:(e-80)/e;D.style.height=e<768?3*(e-80)/4+"px":"",D.style.transform="scale("+n+") translateY("+77/n+"px) translateX("+t/n+"px)"}function B(e){1!==e.nodeType&&(e=this);var t=new FormData,n=e.dataset.name,s=e.value,a=e.closest(".config__item").id.split("_")[1];"heading"===n&&(document.getElementById("aside_"+a).getElementsByClassName("aside__item-name")[0].textContent=""!==s?s:e.placeholder),t.append("id",a),t.append("name",n),t.append("value",s);var i={url:"/slide/update/field",type:"POST",data:t,beforeSend:function(){ie.classList.remove("config__status--error"),ie.classList.add("config__status--updating")},success:function(e){if(e=JSON.parse(e),ie.classList.remove("config__status--updating"),76!==parseInt(e.code))return pit.notification.notify({type:"warning",message:e.message}),pit.core.log(e.message,"warning",q),ie.classList.add("config__status--error"),!1;document.getElementById("slide_"+a).innerHTML=e.slide},error:function(e){return pit.core.log("ajax error occur on updating field of slide content","error",q,e),ie.classList.remove("config__status--updating"),ie.classList.add("config__status--error"),!1}};pit.ajax.send(i)}function C(){this.checked?this.value=this.dataset.value:this.value=0,B(this)}function k(){J.classList.toggle("hide"),U.classList.toggle("hide"),X.classList.toggle("hide")}function x(){k();var e=new FormData;e.append("id",z),e.append("name",W.value);var t={url:"/presentation/editname",type:"POST",data:e,beforeSend:function(){ie.classList.remove("config__status--error"),ie.classList.add("config__status--updating")},success:function(e){if(e=JSON.parse(e),ie.classList.remove("config__status--updating"),54!==parseInt(e.code))return pit.notification.notify({type:e.type,message:e.message}),pit.core.log(e.message,e.type,q),ie.classList.add("config__status--error"),!1;J.innerHTML=W.value,document.getElementsByTagName("title")[0].innerHTML=W.value+" | Prezentit"},error:function(e){return pit.core.log("ajax error occur on updating presentation name","error",q,e),ie.classList.remove("config__status--updating"),ie.classList.add("config__status--error"),!1}};pit.ajax.send(t)}function I(){var e=(this.closest(".config__item").id.split("_")[1],this),t=this.getElementsByClassName("bg-image__image")[0];pit.transport.init({url:"/transport/1",beforeSend:function(){var n=new FileReader,s=pit.transport.getInput(),a=s.files[0];n.readAsDataURL(a),e.classList.add("bg-image--with-image"),ie.classList.remove("config__status--error"),ie.classList.add("config__status--updating"),n.onload=function(e){t.classList.add("bg-image--loading"),t.src=e.target.result}},success:function(n){if(n=JSON.parse(n),ie.classList.remove("config__status--updating"),pit.notification.notify({type:n.status,message:n.message}),88!==parseInt(n.code))return e.classList.remove("bg-image--with-image"),ie.classList.add("config__status--error"),!1;t.src=n.icon_url,t.classList.remove("bg-image--loading"),e.removeEventListener("click",I),e.addEventListener("click",S),e.value=n.name,B(e)},error:function(e){return pit.core.log("ajax error occur on updating background","error",q,e),ie.classList.remove("config__status--updating"),ie.classList.add("config__status--error"),!1}})}function S(){var e=this,t=this.getElementsByClassName("bg-image__image")[0];e.classList.remove("bg-image--with-image"),e.removeEventListener("click",S),e.addEventListener("click",I),e.value="",t.src="/",B(e)}function T(){var e=this.closest(".answer"),t=parseInt(this.dataset.number);if(re[e.dataset.answer].length<=2)return pit.notification.notify({type:"warning",message:"Минимальное количество ответов - 2"}),!1;"true"===e.dataset.image&&this.removeEventListener("click",O),e.getElementsByTagName("input")[t].removeEventListener("keyup",M),e.getElementsByClassName("js-option-delete")[t].removeEventListener("click",T);for(var n=t+1;n<re[e.dataset.answer].length;n++)for(var s=e.querySelectorAll('[data-number="'+n+'"]'),a=0;a<s.length;a++)s[a].dataset.number=n-1;re[e.dataset.answer].splice(t,1),e.querySelector(".answer__item:nth-child("+(t+1)+")").remove(),e.getElementsByClassName("js-answers-json")[0].value=JSON.stringify(re[e.dataset.answer]),B(e.getElementsByClassName("js-answers-json")[0])}function j(){var e=this.closest(".answer");if(re[e.dataset.answer].length>=8)return pit.notification.notify({type:"warning",message:"Макисмальное количество ответов - 8"}),!1;var t=pit.draw.node("LI","form-group__control-group answer__item");t.innerHTML='<input type="text" class="form-group__control form-group__control-group-input answer__value input-with-counter" maxlength="60" data-number="'+re[e.dataset.answer].length+'">',"true"===e.dataset.image&&(t.innerHTML+='<a class="form-group__control-group-addon b-l-0 answer__image " title="Картинка ответа" data-number="'+re[e.dataset.answer].length+'"><i class="fa fa-image bg-image__icon" aria-hidden="true"></i><i class="fa fa-close bg-image__close" aria-hidden="true"></i><img src="/" class="bg-image__image" data-src=""></a>'),t.innerHTML+='<a class="form-group__control-group-addon js-option-delete" data-number="'+re[e.dataset.answer].length+'"><i class="fa fa-trash" aria-hidden="true"></i></a>',"true"===e.dataset.image&&t.getElementsByClassName("answer__image")[0].addEventListener("click",O),t.getElementsByTagName("input")[0].addEventListener("keyup",M),pit.form.createCounter(t.getElementsByTagName("input")[0],60),t.getElementsByClassName("js-option-delete")[0].addEventListener("click",T),e.getElementsByClassName("answer__list")[0].appendChild(t),re[e.dataset.answer].push({text:"",image:""}),e.getElementsByClassName("js-answers-json")[0].value=JSON.stringify(re[e.dataset.answer]),B(e.getElementsByClassName("js-answers-json")[0])}function O(){var e=this.closest(".answer"),t=this.dataset.number,n=this,s=this.getElementsByClassName("bg-image__image")[0];pit.transport.init({url:"/transport/2",beforeSend:function(){var e=new FileReader,t=pit.transport.getInput(),a=t.files[0];e.readAsDataURL(a),n.classList.add("bg-image--with-image"),ie.classList.remove("config__status--error"),ie.classList.add("config__status--updating"),e.onload=function(e){s.classList.add("bg-image--loading"),s.src=e.target.result}},success:function(a){if(a=JSON.parse(a),ie.classList.remove("config__status--updating"),pit.notification.notify({type:a.status,message:a.message}),88!==parseInt(a.code))return n.classList.remove("bg-image--with-image"),ie.classList.add("config__status--error"),!1;s.src=a.icon_url,s.classList.remove("bg-image--loading"),n.removeEventListener("click",O),n.addEventListener("click",H),re[e.dataset.answer][t].image=a.name,e.getElementsByClassName("js-answers-json")[0].value=JSON.stringify(re[e.dataset.answer]),B(e.getElementsByClassName("js-answers-json")[0])},error:function(e){return pit.core.log("ajax error occur on updating answer image","error",q,e),ie.classList.remove("config__status--updating"),ie.classList.add("config__status--error"),!1}})}function H(){var e=this.closest(".answer"),t=this,n=this.dataset.number;t.classList.remove("bg-image--with-image"),t.removeEventListener("click",H),t.addEventListener("click",O),re[e.dataset.answer][n].image="",e.getElementsByClassName("js-answers-json")[0].value=JSON.stringify(re[e.dataset.answer]),B(e.getElementsByClassName("js-answers-json")[0])}function M(){var e=this.closest(".answer"),t=this.dataset.number;re[e.dataset.answer][t].text=this.value,e.getElementsByClassName("js-answers-json")[0].value=JSON.stringify(re[e.dataset.answer]),B(e.getElementsByClassName("js-answers-json")[0])}function F(){this.checked?P(this.closest(".config__item").getElementsByClassName("answer__item")):R(this.closest(".config__item").getElementsByClassName("answer__item"))}function P(e){e[0].closest(".answer").dataset.image=!0;for(var t=null,n=0;n<e.length;n++)t=pit.draw.node("A","form-group__control-group-addon b-l-0 answer__image ",{title:"Картинка ответа","data-number":n}),t.innerHTML='<i class="fa fa-image bg-image__icon" aria-hidden="true"></i><i class="fa fa-close bg-image__close" aria-hidden="true"></i><img src="/" class="bg-image__image" data-src="">',pit.core.insertBefore(e[n].getElementsByClassName("js-option-delete")[0],t),t.addEventListener("click",O),t=null}function R(e){e[0].closest(".answer").dataset.image=!1;for(var t=e[0].closest(".answer"),n=0;n<re[t.dataset.answer].length;n++)e[n].getElementsByClassName("answer__image")[0].removeEventListener("click",O),e[n].getElementsByClassName("bg-image__image")[0].dataset.src="",e[n].getElementsByClassName("answer__image")[0].remove(),re[t.dataset.answer][n].image="";t.getElementsByClassName("js-answers-json")[0].value=JSON.stringify(re[t.dataset.answer]),B(t.getElementsByClassName("js-answers-json")[0])}function A(){k(),W.value=J.innerHTML,W.focus()}var q="edit-presentation",D=null,J=null,z=null,U=null,X=null,W=null,G=null,V=null,Q=null,K=null,Y=null,Z=null,$=null,ee=null,te=null,ne=null,se=null,ae=null,ie=null,oe=null,re=null;const le=[{type:1,name:"Заголовок",icon:"fa-header",image:"heading_ru.png"},{type:2,name:"Изображение",icon:"fa-image",image:"image_ru.png",options:[{id:"image_position_center",type:"radio",name:"2_image_position",data_name:"image_position",data_value:"1",title:"Изображение по центру слайда"},{id:"image_position_full",type:"radio",name:"2_image_position",data_name:"image_position",data_value:"2",title:"Изображение на весь слайд"}]},{type:3,name:"Параграф",icon:"fa-paragraph",image:"paragraph_ru.png"},{type:4,name:"Слайд с вопросом",icon:"fa-bar-chart",image:"choices_ru.png",options:[{id:"4_answer_with_image",type:"checkbox",name:"4_answers_with_image",data_name:"answers_with_image",data_value:"1",title:"Ответы с изображением"},{id:"4_results_in_percents",type:"checkbox",name:"4_results_in_percents",data_name:"results_in_percents",data_value:"1",title:"Выводить результаты в процентах"}]}];return e.init=function(){t()===n()===s()===a()===i()===o()?pit.core.log("Module loaded","log",q):pit.core.log("Module has not loaded","error",q)},e}({})},,,function(e,t){},function(e,t,n){n(4),n(16),n(12),e.exports=function(e){return e.core=n(0),e.draw=n(5),e.transport=n(11),e.ajax=n(6),e.aside=n(7),e.collapse=n(1),e.cookies=n(2),e.tabs=n(10),e.form=n(8),e.notification=n(3),e.present=n(9),e.editPresent=n(13),e}({})}]);